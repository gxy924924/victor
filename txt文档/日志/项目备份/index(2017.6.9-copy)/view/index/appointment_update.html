<!DOCTYPE html>
<html lang="en">
<head>
	{include file="public/sorand/title.html"}

	<link href="/public/css/Index.index.index.css" rel="stylesheet"></link>
	<!-- date专用 -->
	<link rel="stylesheet" href="/public/date/lib/themes/default.css" id="theme_base">
	<link rel="stylesheet" href="/public/date/lib/themes/default.date.css" id="theme_date">
	<link rel="stylesheet" href="/public/date/lib/themes/default.time.css" id="theme_time">
	<!-- date专用 -->


</head>
<body>
	{include file="public/sorand/header.html"}
	<div class="container text-center">
	<div class="panel panel-info">
	<div class="panel-heading">
				客户信息
		</div>	
		
		<div class="panel panel-body">
			<form action="{$Think.const.URL_PATH}/index/index/appoint_update_do" method="post" id="add_new_form">
		      	<div class="modal-body">
		      		<div class="input-group">
					  <span class="input-group-addon">id　　　　</span>
					  <input type="text" class="form-control" name="user_id" value="{$appo_info[0]['id']}" readonly>
					</div>
		    		<div class="input-group">
					  <span class="input-group-addon">客户名称：</span>
					  <input type="text" class="form-control" placeholder="请填写名称" name="name" id="guest_name" value="{$appo_info[0]['name']}">
					</div>
					<div class="input-group">
					  <span class="input-group-addon">客户电话：</span>
					  <input type="text" class="form-control" placeholder="请填写电话，多个电话请用空格隔开" name="tel" id="guest_tel" value="{$appo_info[0]['tel']}">
					</div>
					<div class="input-group">
					  <span class="input-group-addon">预约时间：</span>

					  <style>
						.picker__nav--next,.picker__nav--prev{
						height: 40px;
						}
					  </style>
					  <?php $date_time=explode(" ",$appo_info[0]['appointment_time'])?>
					  <input class="form-control js__datepicker" type="text" placeholder="请输入日期：" name="time_date" id="time_date"><span class="input-group-addon" value="aaa"></span>
					 	<select class="form-control" name="time_time" id="time_time">

					  	<option value="">-请选择-</option>
					  	<?php for($i=8;$i<17;$i++):?>
							<?php if($date_time[1]==$i.":00"):?>
								<option value="{$i}:30" selected="selected">{$i}:00</option>
							<?php else:?>
								<option value="{$i}:00">{$i}:00</option>
							<?php endif;?>
							<?php if($date_time[1]==$i.":30"):?>
								<option value="{$i}:30" selected="selected">{$i}:30</option>
							<?php else:?>
								<option value="{$i}:30">{$i}:30</option>
							<?php endif;?>
					  	<?php endfor;?>
					  </select>
					</div>

					<div class="input-group">
					  <span class="input-group-addon">性别：</span>

					  <span class="input-group-addon padding-small">
					 <?php if($appo_info[0]['sex']=="女"):?>
						<input type="radio"  name="sex" checked="checked"  value="女">
					<?php else:?>
						<input type="radio"  name="sex"  value="女">
					<?php endif;?>
					  </span>
					  <span class="input-group-addon">女</span>
					  <span class="input-group-addon padding-small">
					  	<?php if($appo_info[0]['sex']=="男"):?>
						<input type="radio"  name="sex" value="男">
						<?php else:?>
							<input type="radio"  name="sex" value="男">
						<?php endif;?>
					  </span>
					  <span class="input-group-addon">男</span>

					  <span class="input-group-addon">年龄：</span>
					  <select class="form-control" name="age" id="guest_age">
					  	<option value="">-请选择-</option>
					  	<?php for($i=14;$i<80;$i++):?>

					  		<?php if($appo_info[0]['age']==$i):?>
								<option value="{$i}" selected="selected">{$i}</option>
							<?php else:?>
								<option value="{$i}">{$i}</option>
							<?php endif;?>

					  	<?php endfor;?>
					  </select>
					</div>

					<div class="input-group">
					  <span class="input-group-addon">预约方式：</span>
					  <select class="form-control" name="appointment_type">
					  	<option value="0">-请选择-</option>
					  	<?php foreach ($appointment_type as $v) :?>
					  		

								<?php if($appo_info[0]['appointment_type']==$v['appointment_type']):?>
									<option value="{$v['appointment_type']}" selected="selected">{$v['appointment_type']}</option>
								<?php else:?>
									<option value="{$v['appointment_type']}">{$v['appointment_type']}</option>
								<?php endif;?>
					  		
					  	<?php endforeach; ?>
					  </select>
					</div>

					<div class="input-group">
					  <span class="input-group-addon">预约类型：</span>
					  <select class="form-control" name="appointment_style">
					  	<option value="未选择">-请选择-</option>
					  	<?php foreach($appointment_style as $v) :?>

					  		<?php if($appo_info[0]['appointment_style']==$v['style']):?>
					  			<option value="{$v['style']}" selected="selected">{$v['style']}</option>
							<?php else:?>
								<option value="{$v['style']}">{$v['style']}</option>
							<?php endif;?>
					  		
					  	<?php endforeach; ?>
					  </select>
					</div>

					<div class="input-group">
					  <span class="input-group-addon">预约项目：</span>
					  <select class="form-control" name="appointment_item">
					  	<option value="0">-请选择-</option>
					  </select>
					</div>

					<div class="input-group">
					  <span class="input-group-addon">预约订金：</span>
					  <input type="text" class="form-control" placeholder="填入整数" name="bargain_money" id="guest_tel" value="{$appo_info[0]['bargain_money']}">
					</div>
					<div class="input-group">
					  <span class="input-group-addon">项目价格：</span>
					  <input type="text" class="form-control" placeholder="填入整数" name="price" id="guest_tel" value="{$appo_info[0]['price']}">
					</div>

					<div class="input-group">
					<?php $city=explode("-",$appo_info[0]['position'])?>
					  <span class="input-group-addon">城市地点：</span>
					  <select name="city_provice" class="form-control" id="province">
					  	<option value="">-请选择(省)-</option>
					  	<?php foreach($province as $v) :?>

					  		<?php if($city[0]==$v['name']):?>
								<option value="{$v['id']}-{$v['name']}" selected="selected">{$v['name']}</option>
							<?php else:?>
								<option value="{$v['id']}-{$v['name']}">{$v['name']}</option>
							<?php endif;?>

					  		<option value="{$v['id']}-{$v['name']}">{$v['name']}</option>
					  	<?php endforeach; ?>
					  </select>
					  <select name="city_city" class="form-control" id="city">
					  	<option value="">-请先选择省-</option>
					  </select>
					  <select name="city_county" class="form-control" id="county">
					  	<option value="">-请先选择省-</option>
					  </select>
					</div>
					
					<div class="input-group">
					  <span class="input-group-addon">备注：</span>
					  <textarea name="adder_info" cols="30" rows="10">{$appo_info[0]['adder_info']}</textarea>
					</div>
		      	</div><!-- modal-body -->
		      <div class="modal-footer">
		      	<button type="button" class="btn btn-primary" id="add_new_submit">确认</button>
		        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
		      </div>
		    </form>
		</div>
	</div>
</div>

	<!-- 省市县三级联动隐藏地址（勿删） -->
<input type="hidden" value='{$city_get_url}' id="city_get_url">

<!-- 时间隐藏 -->
<input type="hidden" value='{$date_time[0]}' id="date_time">
<!-- 省市县编码隐藏 -->
<?php $city_num=explode("-",$appo_info[0]['position_num']);?>
<input type="hidden" id="hid_prov_id" value="{$city_num[0]}">
<input type="hidden" id="hid_city_id" value="{$city_num[1]}">
<input type="hidden" id="hid_county_id" value="<?php echo empty($city_num[2])?0:$city_num[2];?>">
<!-- 省市县隐藏 -->
<input type="hidden" id="city_city" value="{$city[1]}">
<!-- <input type="hidden" id="hid_city_id" value="{$city_num[1]}"> -->

<script>
	//传值给date
	$(".js__datepicker").val($("#date_time").val());

	//传值给省
	// alert($("#hid_province").val());

	// $(document).ready(function(){
	// 	var option="option[text='"+$("#hid_province").val()+"']";
	// 	// alert($("#province").find(option).val());

	// 	// $("#province").find(option).attr("selected","selected");
	// 	$("#province").val($("#hid_province").val());
	// 	alert($("#province").val());
	// });
	$(document).ready(function(){
		$("#province").change();
		$("#city").change();
	});
	
	
	$("#province").change(function(){

		$("#city").empty();
		$("#city").append("<option value=''>-请选择(市)-</option>");
		$("#county").empty();
		$("#county").append("<option value=''>请再选择市</option>");
		var id=$("#province").val();
		var prov_id=$("#hid_prov_id").val();
		var city_id=$("#hid_city_id").val();
		// alert(city_id);
		if (prov_id!=0) {
			id=prov_id;
			$("#hid_prov_id").val(0);
		}

		// alert($("#hid_province_id").val());
		var url=$("#city_get_url").val();
		// alert(url);
		$.get(url,{"id":id},function(data){
		
			var obj = eval('(' + data + ')');
			for (var i = 0; i < obj.length; i++) {
				var append_val="<option value="+obj[i]['id']+'-'+obj[i]['name']+">"+obj[i]['name']+"</option>";
				if(city_id==obj[i]['id']){
					var append_val="<option value="+obj[i]['id']+'-'+obj[i]['name']+"  selected='selected'>"+obj[i]['name']+"</option>";
				}
				$("#city").append(append_val);
			};
		},"json");
	});

	$("#city").change(function(){
		$("#county").empty();
		$("#county").append("<option value=''>-请选择(县)-</option>");
		var id=$("#city").val();
		var url=$("#city_get_url").val();
		var city_id=$("#hid_city_id").val();
		var county_id=$("#hid_county_id").val();
		if (city_id!=0) {
			id=city_id;
			$("#hid_city_id").val(0);
		}
		$.get(url,{"id":id},function(data){
			var obj = eval('(' + data + ')');
			for (var i = 0; i < obj.length; i++) {
				var append_val="<option value="+obj[i]['id']+'-'+obj[i]['name']+">"+obj[i]['name']+"</option>";
				if(county_id==obj[i]['id']){
					var append_val="<option value="+obj[i]['id']+'-'+obj[i]['name']+"  selected='selected'>"+obj[i]['name']+"</option>";
				}
				$("#county").append(append_val);
			};
		},"json");
	});

	$("#add_new_submit").click(function(){
		var arr1=new Array();//表单id信息
		arr1=['guest_name','guest_tel','time_date','time_time','province','city'];

		var arr2=new Array();//表单ID内容
		arr2=['输入姓名','输入电话',"填入预约日期",'填入预约时间','选择省','选择市'];

		flag=0;
		for (var i =  0; i < arr1.length; i++) {
			id_info="#"+arr1[i];
			// alert(id_info);
			if($(id_info).val()){}else{
				alert('请'+arr2[i]);
				flag++;
				return false;
			}
		}

		if (!flag) {
			$("#add_new_form").submit();
		}
	});


</script>


</script>
	<!-- date专用 -->
	<script src="/public/date/lib/picker.js"></script>
    <script src="/public/date/lib/picker.date.js"></script>
    <script src="/public/date/lib/picker.time.js"></script>
    <script src="/public/date/demo/scripts/main.js"></script>
	<!-- date专用 -->
</body>
</html>
